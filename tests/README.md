# Тесты для Mini CRM Leads

## Описание

Асинхронные тесты для всех эндпоинтов API, написанные с использованием pytest и pytest-asyncio.

## Структура тестов

- `test_api/test_base.py` - тесты для базовых эндпоинтов (root, health)
- `test_api/test_operators.py` - тесты для CRUD операций с операторами
- `test_api/test_sources.py` - тесты для CRUD операций с источниками и весами операторов
- `test_api/test_leads.py` - тесты для CRUD операций с лидами
- `test_api/test_contacts.py` - тесты для CRUD операций с обращениями и автоматическим распределением

## Запуск тестов

### Установка зависимостей

```bash
pip install -e ".[dev]"
```

или с использованием uv:

```bash
uv sync --dev
```

### Запуск всех тестов

```bash
pytest
```

### Запуск конкретного файла тестов

```bash
pytest tests/test_api/test_operators.py
```

### Запуск конкретного теста

```bash
pytest tests/test_api/test_operators.py::test_create_operator
```

### Запуск с подробным выводом

```bash
pytest -v
```

### Запуск с выводом print-ов

```bash
pytest -s
```

## Особенности

- Используется SQLite в памяти для тестовой базы данных
- Каждый тест выполняется в изолированной транзакции
- Фикстуры автоматически создают тестовые данные (операторы, источники, лиды)
- Тесты полностью асинхронные и используют httpx для HTTP-запросов

